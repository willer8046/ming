<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Soo Design â€” í¬íŠ¸í´ë¦¬ì˜¤ ê²Œì‹œíŒ</title>
  <meta name="description" content="ìˆ˜ë””ìì¸ì˜ í¬íŠ¸í´ë¦¬ì˜¤." />
  <meta name="theme-color" content="#87ceeb" />
  <style>
    :root{
      --bg:#f5fbff;--card:#fff;--text:#2f2f2f;--muted:#6d7a85;
      --primary:#5dade2;--primary-2:#a3d5f7;--ring:rgba(93,173,226,.4);
      --shadow:0 8px 22px rgba(0,0,0,.08);--radius:16px;--container:1120px
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:"Noto Sans KR",Pretendard,ui-sans-serif,system-ui;color:var(--text);background:var(--bg)}
    a{color:inherit;text-decoration:none}
    img{max-width:100%;height:auto;border-radius:12px}
    .container{width:min(100%,var(--container));margin-inline:auto;padding:20px}
    header{position:sticky;top:0;background:rgba(255,255,255,.95);backdrop-filter:blur(8px);box-shadow:var(--shadow);z-index:50}
    nav{display:flex;align-items:center;justify-content:space-between;height:64px}
    .brand{display:flex;align-items:center;gap:10px;font-weight:800}
    .logo{width:28px;height:28px;border-radius:50%;background:var(--primary)}
    .btn{display:inline-flex;align-items:center;gap:8px;padding:10px 14px;border-radius:12px;border:1px solid #e6eef5;background:#fff;font-weight:700;cursor:pointer}
    .btn.primary{background:var(--primary);color:#fff;border-color:transparent}
    .btn.ghost{background:#f0f7fc}
    .btn.danger{border-color:#ffd5d5;background:#fff0f0}
    h1{font-size:clamp(24px,3.5vw,34px);margin:12px 0}
    .controls{display:grid;grid-template-columns:1fr auto auto;gap:10px;margin:16px 0}
    .search{display:flex;align-items:center;gap:8px;padding:12px 14px;border-radius:12px;border:1px solid #e3edf6;background:#fff}
    input,select,textarea{width:100%;border:1px solid #e3edf6;border-radius:12px;padding:10px 12px;outline:none;background:#fff}
    input:focus,select:focus,textarea:focus{box-shadow:0 0 0 6px var(--ring);border-color:var(--primary-2)}
    .grid{display:grid;grid-template-columns:repeat(12,1fr);gap:14px}
    .card{grid-column:span 4;background:var(--card);border:1px solid #f0f0f0;border-radius:14px;overflow:hidden;box-shadow:var(--shadow);display:flex;flex-direction:column}
    .card .media{position:relative;aspect-ratio:16/9;background:#eef6fb}
    .card .media img{width:100%;height:100%;object-fit:cover;border-radius:0}
    .yt-badge{position:absolute;left:10px;top:10px;background:rgba(0,0,0,.55);color:#fff;border-radius:999px;padding:4px 8px;font-size:12px}
    .card .meta{padding:12px 14px}
    .card .title{font-weight:800}
    .pill{display:inline-flex;gap:6px;align-items:center;padding:6px 10px;border-radius:999px;background:#eef7fd;border:1px solid #d9ecfb;font-size:12px;margin-right:6px}
    @media(max-width:980px){.card{grid-column:span 12}.controls{grid-template-columns:1fr}}
    .pager{display:flex;gap:6px;justify-content:center;margin:22px 0}
    .pager button{padding:8px 12px;border-radius:10px;border:1px solid #e3edf6;background:#fff;cursor:pointer}
    .pager .current{background:var(--primary);color:#fff;border-color:transparent}
    dialog{border:0;border-radius:20px;padding:0;max-width:min(980px,95vw);box-shadow:0 24px 60px rgba(0,0,0,.25)}
    .modal{display:grid;grid-template-columns:1.15fr .85fr;gap:18px;background:#fff;border-radius:20px;overflow:hidden}
    .modal .body{padding:18px}
    .close{position:absolute;top:10px;right:10px}
    .media-stack{display:grid;gap:10px}
    .media-stack iframe,.media-stack img{width:100%;border-radius:12px}
    @media(max-width:900px){.modal{grid-template-columns:1fr}}
    details.admin{display:none}
    .admin-tools{display:none;gap:8px;margin-top:10px}
    body.is-admin .admin-tools{display:flex}
    /* ==== ìœ íŠœë¸Œ hover ì¬ìƒ ì¸ë„¤ì¼ ==== */
.video-thumb {
  position: relative;
  overflow: hidden;
  border-radius: 12px;
  cursor: pointer;
}
.video-thumb img {
  width: 100%;
  height: auto;
  display: block;
  transition: opacity 0.3s;
}
.video-thumb iframe {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  border: 0;
  display: none;
}
.video-thumb:hover img {
  opacity: 0;
}
.video-thumb:hover iframe {
  display: block;
}
/* ===== ìœ íŠœë¸Œ ì‡¼ì¸ (ì„¸ë¡œ ì˜ìƒ) ì§€ì› ===== */
.video-horizontal {
  aspect-ratio: 16 / 9;
}

.video-vertical {
  aspect-ratio: 9 / 16;
}
  </style>
</head>
<body>
  <header>
    <div class="container">
      <nav>
        <div class="brand">
          <span class="logo" aria-hidden="true"></span>
          <a href="index.html" aria-label="í™ˆìœ¼ë¡œ">
            <img src="images/logo_main.png" alt="Soo Design ë¡œê³ " class="logo" />
          </a>
        </div>
        <div style="display:flex;gap:10px">
          <a class="btn ghost" href="index.html#work">â† í™ˆí˜ì´ì§€ë¡œ</a>
          <button class="btn" id="btn-admin-login">ê´€ë¦¬ì ë¡œê·¸ì¸</button>
        </div>
      </nav>
    </div>
  </header>

  <main class="container" id="main">
    <h1>í¬íŠ¸í´ë¦¬ì˜¤</h1>
    <p class="kicker" style="color:var(--muted)">ìˆ˜ë””ìì¸ì—ì„œ ì§ì ‘ ì‹œê³µí•œ í˜„ì¥ì…ë‹ˆë‹¤.</p>

    <div class="controls" role="region" aria-label="ê²€ìƒ‰ ë° í•„í„°">
      <div class="search" style="gap:10px">
        <input id="q" placeholder="í”„ë¡œì íŠ¸ëª…, ì„¤ëª…, íƒœê·¸ ê²€ìƒ‰" aria-label="ê²€ìƒ‰ì–´" />
      </div>
      <select id="tag" aria-label="íƒœê·¸ í•„í„°"><option value="">ì „ì²´ íƒœê·¸</option></select>
      <button class="btn" id="reset">ì´ˆê¸°í™”</button>
    </div>

    <section class="grid" id="grid" aria-live="polite"></section>
    <div class="pager" id="pager" role="navigation" aria-label="í˜ì´ì§€ ì´ë™"></div>

    <!-- ê´€ë¦¬ì(ë¡œê·¸ì¸ í›„ ë…¸ì¶œ) -->
    <details class="admin">
      <summary>ê´€ë¦¬ì ëª¨ë“œ(ë¡œì»¬ í¸ì§‘ â†’ JSON ë‚´ë³´ë‚´ê¸°/ê°€ì ¸ì˜¤ê¸°)</summary>
      <div class="card" style="padding:16px">
        <div class="admin-grid" style="display:grid;grid-template-columns:1fr 1fr;gap:12px">
          <div>
            <h3 style="margin:6px 0">ìƒˆ í•­ëª© ì¶”ê°€</h3>
            <label>ì œëª©<input id="f-title"/></label>
            <label class="mt-2">ì„¤ëª…<textarea id="f-desc" rows="3"></textarea></label>
            <label class="mt-2">íƒœê·¸(ì‰¼í‘œë¡œ êµ¬ë¶„)<input id="f-tags" placeholder="ì¹´í˜, ë¦¬ëª¨ë¸ë§"/></label>
            <label class="mt-2">ëŒ€í‘œ ì´ë¯¸ì§€ URL(ì¸ë„¤ì¼ ìš©)<input id="f-img" placeholder="https://...jpg"/></label>
            <label class="mt-2">ìœ íŠœë¸Œ URL(ì²« í™”ë©´, ì„ íƒ)<input id="f-yt" placeholder="https://youtu.be/VIDEO_ID ë˜ëŠ” https://www.youtube.com/watch?v=VIDEO_ID"/></label>
            <label class="mt-2">ìƒì„¸ ì´ë¯¸ì§€ URL(ì¤„ë°”ê¿ˆìœ¼ë¡œ ìµœëŒ€ 10ì¥)
              <textarea id="f-gallery" rows="4" placeholder="https://...1.jpg
https://...2.jpg"></textarea>
            </label>
            <button class="btn primary mt-2" id="add">ì¶”ê°€</button>
          </div>
          <div>
            <h3 style="margin:6px 0">ë°ì´í„° ê´€ë¦¬</h3>
            <div style="display:flex;gap:8px;flex-wrap:wrap">
              <button class="btn" id="export">JSON ë‚´ë³´ë‚´ê¸°</button>
              <label class="btn"><input id="import" type="file" accept="application/json" hidden/>JSON ê°€ì ¸ì˜¤ê¸°</label>
              <button class="btn" id="clear">ëª¨ë“  í•­ëª© ì‚­ì œ(ë¡œì»¬)</button>
            </div>
            <p class="kicker" style="color:var(--muted)">â€» í¸ì§‘ ë‚´ìš©ì€ ë¸Œë¼ìš°ì € <strong>localStorage</strong>ì— ì„ì‹œ ì €ì¥ë©ë‹ˆë‹¤. ë‚´ë³´ë‚¸ JSONì„ ë¦¬í¬ì§€í† ë¦¬ì— <code>portfolio-data.json</code>ìœ¼ë¡œ ì—…ë¡œë“œí•˜ë©´ ì „ì²´ì— ë°˜ì˜ë©ë‹ˆë‹¤.</p>
          </div>
        </div>
      </div>
    </details>

    <!-- ìƒì„¸ ë³´ê¸° -->
    <dialog id="detail">
      <form method="dialog" style="position:relative">
        <button class="btn close" aria-label="ë‹«ê¸°">ë‹«ê¸°</button>
        <div class="modal">
          <div class="media-stack" id="detail-gallery"></div>
          <div class="body">
            <h2 id="detail-title" style="margin:0 0 8px"></h2>
            <div id="detail-tags" style="margin-bottom:10px"></div>
            <p id="detail-desc" style="color:var(--muted)"></p>
            <div class="admin-tools">
              <button type="button" class="btn" id="btn-edit-in-detail">ì´ í•­ëª© ìˆ˜ì •</button>
              <button type="button" class="btn danger" id="btn-del-in-detail">ì‚­ì œ</button>
            </div>
          </div>
        </div>
      </form>
    </dialog>

    <!-- ìˆ˜ì • -->
    <dialog id="edit">
      <form method="dialog" style="position:relative">
        <button class="btn close" aria-label="ë‹«ê¸°">ë‹«ê¸°</button>
        <div class="modal">
          <div class="body" style="grid-column: span 2">
            <h2 style="margin:0 0 8px">í¬íŠ¸í´ë¦¬ì˜¤ ìˆ˜ì •</h2>
            <input type="hidden" id="e-id" />
            <label class="mt-2">ì œëª©<input id="e-title" /></label>
            <label class="mt-2">ì„¤ëª…<textarea id="e-desc" rows="3"></textarea></label>
            <label class="mt-2">íƒœê·¸(ì‰¼í‘œë¡œ êµ¬ë¶„)<input id="e-tags" /></label>
            <label class="mt-2">ëŒ€í‘œ ì´ë¯¸ì§€ URL(ì¸ë„¤ì¼)<input id="e-cover" /></label>
            <label class="mt-2">ìœ íŠœë¸Œ URL(ì„ íƒ)<input id="e-yt" /></label>
            <label class="mt-2">ìƒì„¸ ì´ë¯¸ì§€ URL(ì¤„ë°”ê¿ˆ ìµœëŒ€ 10ì¥)<textarea id="e-gallery" rows="4"></textarea></label>
            <div style="display:flex;gap:8px;margin-top:12px">
              <button type="button" class="btn primary" id="e-save">ì €ì¥</button>
              <button type="button" class="btn" id="e-cancel">ì·¨ì†Œ</button>
            </div>
            <p class="kicker" style="color:var(--muted);margin-top:10px">ì €ì¥í•˜ë©´ <strong>localStorage</strong>ì— ë°˜ì˜ë©ë‹ˆë‹¤. ì „ì²´ ë°˜ì˜ì€ JSON ë‚´ë³´ë‚´ê¸° â†’ <code>portfolio-data.json</code> ì—…ë¡œë“œ.</p>
          </div>
        </div>
      </form>
    </dialog>
  </main>

  <script>
    // ===== ìœ í‹¸: YouTube ID ì¶”ì¶œ & ì¸ë„¤ì¼ =====
  function extractYouTubeId(url = "") {
  if (!url) return "";

  try {
    const u = new URL(url);
    const host = u.hostname.replace("www.", "");

    // 1) youtu.be ë‹¨ì¶• URL
    if (host.includes("youtu.be")) {
      // ì˜ˆ: https://youtu.be/VIDEOID
      return u.pathname.replace("/", "");
    }

    // 2) youtube.com ê³„ì—´
    if (host.includes("youtube.com")) {
      // 2-1) ì¼ë°˜ ë™ì˜ìƒ: ?v=VIDEOID
      const v = u.searchParams.get("v");
      if (v) return v;

      // 2-2) ì‡¼ì¸ : /shorts/VIDEOID
      const segments = u.pathname.split("/").filter(Boolean); // ["shorts","VIDEOID"] í˜•íƒœ
      const shortsIndex = segments.indexOf("shorts");
      if (shortsIndex >= 0 && segments[shortsIndex + 1]) {
        return segments[shortsIndex + 1];
      }

      // 2-3) ì„ë² ë“œ: /embed/VIDEOID
      const embedIndex = segments.indexOf("embed");
      if (embedIndex >= 0 && segments[embedIndex + 1]) {
        return segments[embedIndex + 1];
      }
    }
  } catch (e) {
    // new URL ì‹¤íŒ¨í•˜ë©´ ì•„ë˜ ì •ê·œì‹ìœ¼ë¡œ ì²˜ë¦¬
  }

  // 3) í˜¹ì‹œ ìˆœìˆ˜ IDë§Œ ë“¤ì–´ì˜¨ ê²½ìš°
  if (/^[\w-]{11}$/.test(url)) return url;

  return "";
}

    function ytThumb(id){ return `https://img.youtube.com/vi/${id}/hqdefault.jpg`; }

    // ===== ë°ì´í„° ë¡œë”© =====
    const seedData = [
      { id:1, title:"ë”°ëœ»í•œ í•˜ëŠ˜í†¤ ì¹´í˜ ë¦¬ëª¨ë¸ë§", desc:"ìœ ëŸ½ë¯¸ì¥ ì§ˆê° ìœ„ì— í•˜ëŠ˜ìƒ‰ í¬ì¸íŠ¸ë¡œ ì‚°ëœ»í•œ ë¬´ë“œ.", tags:["ì¹´í˜","ë¦¬ëª¨ë¸ë§"], cover:"https://images.unsplash.com/photo-1505691938895-1758d7feb511?q=80&w=1200&auto=format&fit=crop", youtube:"https://youtu.be/dQw4w9WgXcQ", gallery:["https://images.unsplash.com/photo-1505691938895-1758d7feb511?q=80&w=1200&auto=format&fit=crop"] },
      { id:2, title:"ëª¨ë˜ ì£¼ê±° ì¸í…Œë¦¬ì–´", desc:"í™”ì´íŠ¸&ìŠ¤ì¹´ì´ë¸”ë£¨ íŒ”ë ˆíŠ¸ì™€ ê³¡ì„  ê°€êµ¬ë¡œ ë¶€ë“œëŸ¬ìš´ ë™ì„ .", tags:["ì£¼ê±°","ë¦¬ë¹™"], cover:"https://images.unsplash.com/photo-1501045661006-fcebe0257c3f?q=80&w=1200&auto=format&fit=crop", gallery:["https://images.unsplash.com/photo-1501045661006-fcebe0257c3f?q=80&w=1200&auto=format&fit=crop"] },
      { id:3, title:"ë¸ŒëŸ°ì¹˜ ë ˆìŠ¤í† ë‘", desc:"ë°ì€ í†¤ ëª©ì¬ì™€ í•˜ëŠ˜ìƒ‰ í¬ì¸íŠ¸ ë²½ìœ¼ë¡œ ì²­ëŸ‰í•œ ë¶„ìœ„ê¸°.", tags:["ìƒì—…","ë ˆìŠ¤í† ë‘"], cover:"https://images.unsplash.com/photo-1550985607-b283cf7247d2?q=80&w=1200&auto=format&fit=crop", gallery:["https://images.unsplash.com/photo-1550985607-b283cf7247d2?q=80&w=1200&auto=format&fit=crop"] }
    ];

    const KEY = "soodesign-portfolio";
    let items = [];
    let currentDetailId = null;

    async function loadData(){
      try {
        const res = await fetch("portfolio-data.json", {cache: "no-store"});
        items = res.ok ? await res.json() : seedData;
      } catch(_) { items = seedData; }
      const local = localStorage.getItem(KEY);
      if(local){ try { items = JSON.parse(local); } catch(_){} }
      items.forEach((it,i)=>{
        if(!it.id) it.id = i+1;
        it.tags = it.tags || [];
        it.gallery = (it.gallery || []).slice(0,10); // ìµœëŒ€ 10ì¥ ì œí•œ
        it.youtubeId = extractYouTubeId(it.youtube || "");
        it.isShorts = (it.youtube || "").includes("/shorts/"); // ğŸ‘ˆ ì‡¼ì¸  ì—¬ë¶€
      });
    }
    function saveLocal(){ localStorage.setItem(KEY, JSON.stringify(items)); }

    // ===== ë Œë”ë§ =====
    const grid = document.getElementById('grid');
    const pager = document.getElementById('pager');
    const q = document.getElementById('q');
    const tagSel = document.getElementById('tag');

    const pageSize = 9; let page = 1;

    function uniqueTags(list){ return Array.from(new Set(list.flatMap(i=>i.tags||[]))); }

    function filterItems(){
      const s = (q.value||"").trim().toLowerCase();
      const t = tagSel.value;
      return items.filter(it=>{
        const hay = (it.title + " " + (it.desc||"") + " " + (it.tags||[]).join(" ")).toLowerCase();
        const okText = !s || hay.includes(s);
        const okTag = !t || (it.tags||[]).includes(t);
        return okText && okTag;
      });
    }

    function renderTags(){
      const tags = uniqueTags(items);
      tagSel.innerHTML = '<option value="">ì „ì²´ íƒœê·¸</option>' + tags.map(t=>`<option value="${t}">${t}</option>`).join('');
    }

    function escapeHTML(s){
      return (s||'').replace(/[&<>"']/g, c=>({"&":"&amp;","<":"&lt;"," >":"&gt;","\"":"&quot;","'":"&#39;"}[c]));
    }

function cardMediaHTML(it){
  // ì‡¼ì¸ ì´ë©´ ì„¸ë¡œ(9:16), ì•„ë‹ˆë©´ ê°€ë¡œ(16:9)
  const isShorts = it.isShorts === true;
  const ratioClass = isShorts ? "video-vertical" : "video-horizontal";

  if(it.youtubeId){
    const thumb = ytThumb(it.youtubeId);
    return `
      <div class="media video-thumb ${ratioClass}" data-video="${it.youtubeId}">
        <img 
          src="${thumb}" 
          alt="${escapeHTML(it.title)} ìœ íŠœë¸Œ ì¸ë„¤ì¼" 
          loading="lazy"
        />
        <iframe 
          src="https://www.youtube.com/embed/${it.youtubeId}?autoplay=1&mute=1&controls=0&loop=1&playlist=${it.youtubeId}" 
          allow="autoplay; encrypted-media"
          allowfullscreen
        ></iframe>
        <span class="yt-badge">â–¶ ì˜ìƒ</span>
      </div>`;
  }

  // ìœ íŠœë¸Œê°€ ì—†ëŠ” ê²½ìš°: ê¸°ì¡´ ì´ë¯¸ì§€ ê·¸ëŒ€ë¡œ
  return it.cover
    ? `<div class="media video-horizontal"><img src="${it.cover}" alt="${escapeHTML(it.title)} ëŒ€í‘œ ì´ë¯¸ì§€" loading="lazy"/></div>`
    : `<div class="media video-horizontal"></div>`;
}


    function cardHTML(it){
      return `<article class="card">
        ${cardMediaHTML(it)}
        <div class="meta">
          <div class="title">${escapeHTML(it.title)}</div>
          <p style="color:var(--muted);margin:6px 0 10px">${escapeHTML(it.desc||'')}</p>
          <div>${(it.tags||[]).map(t=>`<span class="pill">#${escapeHTML(t)}</span>`).join('')}</div>
          <div style="margin-top:10px; display:flex; gap:8px; flex-wrap:wrap">
            <button class="btn" data-id="${it.id}" data-open>ìì„¸íˆ ë³´ê¸°</button>
            ${isAdmin()? `<div class="admin-tools" style="display:flex;"><button class="btn" data-id="${it.id}" data-edit>ìˆ˜ì •</button><button class="btn danger" data-id="${it.id}" data-del>ì‚­ì œ</button></div>`:''}
          </div>
        </div>
      </article>`;
    }

    function render(){
      const list = filterItems();
      const total = Math.max(1, Math.ceil(list.length / pageSize));
      if(page>total) page = total;
      const start = (page-1)*pageSize;
      const slice = list.slice(start, start+pageSize);
      grid.innerHTML = slice.map(cardHTML).join('') || `<div class="card" style="grid-column:span 12;padding:18px">ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</div>`;
      let html = '';
      for(let i=1;i<=total;i++){ html += `<button ${i===page? 'class="current"':''} data-pg="${i}">${i}</button>`; }
      pager.innerHTML = html;
    }

    // ===== ìƒì„¸ ë³´ê¸° =====
    const detail = document.getElementById('detail');
    const dTitle = document.getElementById('detail-title');
    const dDesc = document.getElementById('detail-desc');
    const dTags = document.getElementById('detail-tags');
    const dGallery = document.getElementById('detail-gallery');

    function openDetail(id){
      const it = items.find(x=>String(x.id)===String(id));
      if(!it) return;
      currentDetailId = it.id;
      dTitle.textContent = it.title;
      dDesc.textContent = it.desc||'';
      dTags.innerHTML = (it.tags||[]).map(t=>`<span class="pill">#${escapeHTML(t)}</span>`).join('');
      // ì²« í™”ë©´: ìœ íŠœë¸Œ(ìˆìœ¼ë©´) â†’ ì´í›„ ì´ë¯¸ì§€(ìµœëŒ€ 10ì¥)
      const mediaHtml = [];
      if(it.youtubeId){
        mediaHtml.push(`<iframe width="100%" height="360" src="https://www.youtube.com/embed/${it.youtubeId}" title="${escapeHTML(it.title)} ìœ íŠœë¸Œ" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>`);
      } else if(it.cover){
        mediaHtml.push(`<img src="${it.cover}" alt="${escapeHTML(it.title)} ëŒ€í‘œ ì´ë¯¸ì§€" loading="lazy"/>`);
      }
      (it.gallery||[]).slice(0,10).forEach((src,i)=>{
        mediaHtml.push(`<img src="${src}" alt="${escapeHTML(it.title)} ìƒì„¸ ì´ë¯¸ì§€ ${i+1}" loading="lazy"/>`);
      });
      dGallery.innerHTML = mediaHtml.join('');
      detail.showModal();
      document.getElementById('btn-edit-in-detail').style.display = isAdmin()? 'inline-flex':'none';
      document.getElementById('btn-del-in-detail').style.display = isAdmin()? 'inline-flex':'none';
    }

    // ===== ìˆ˜ì • =====
    const edit = document.getElementById('edit');
    const eId = document.getElementById('e-id');
    const eTitle = document.getElementById('e-title');
    const eDesc = document.getElementById('e-desc');
    const eTags = document.getElementById('e-tags');
    const eCover = document.getElementById('e-cover');
    const eYt = document.getElementById('e-yt');
    const eGallery = document.getElementById('e-gallery');

    function openEdit(id){
      const it = items.find(x=>String(x.id)===String(id));
      if(!it) return;
      eId.value = it.id;
      eTitle.value = it.title || '';
      eDesc.value = it.desc || '';
      eTags.value = (it.tags || []).join(', ');
      eCover.value = it.cover || '';
      eYt.value = it.youtube || '';
      eGallery.value = (it.gallery || []).join('\n');
      edit.showModal();
    }

    function applyEdit(){
      const id = eId.value;
      const idx = items.findIndex(x=>String(x.id)===String(id));
      if(idx<0) return alert('í•­ëª©ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
      const tags = eTags.value.split(',').map(s=>s.trim()).filter(Boolean);
      const gallery = eGallery.value.split('\n').map(s=>s.trim()).filter(Boolean).slice(0,10);
      const youtube = eYt.value.trim();
const youtubeId = extractYouTubeId(youtube);
const isShorts = (youtube || "").includes("/shorts/");

items[idx] = {
  ...items[idx],
  title: eTitle.value.trim(),
  desc: eDesc.value.trim(),
  tags,
  cover: eCover.value.trim(),
  youtube,
  youtubeId,
  isShorts,
  gallery
};

      saveLocal();
      renderTags();
      render();
      detail.open && openDetail(id);
      edit.close();
      alert('ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤. (ë¡œì»¬ ì €ì¥) JSON ë‚´ë³´ë‚´ê¸°ë¡œ ë°°í¬ íŒŒì¼ì„ ê°±ì‹ í•˜ì„¸ìš”.');
    }

    function deleteItem(id){
      if(!confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
      const idx = items.findIndex(x=>String(x.id)===String(id));
      if(idx<0) return;
      items.splice(idx,1);
      saveLocal();
      renderTags();
      render();
      detail.close();
      alert('ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤. (ë¡œì»¬ ì €ì¥) JSON ë‚´ë³´ë‚´ê¸°ë¡œ ë°°í¬ íŒŒì¼ì„ ê°±ì‹ í•˜ì„¸ìš”.');
    }

    // ===== ì´ë²¤íŠ¸ =====
    q.addEventListener('input', ()=>{ page=1; render(); });
    tagSel.addEventListener('change', ()=>{ page=1; render(); });
    document.getElementById('reset').addEventListener('click', ()=>{ q.value=''; tagSel.value=''; page=1; render(); });
    pager.addEventListener('click', (e)=>{ const btn=e.target.closest('button[data-pg]'); if(!btn) return; page=Number(btn.dataset.pg); render(); });
    grid.addEventListener('click', (e)=>{
      const openBtn = e.target.closest('button[data-open]');
      const editBtn = e.target.closest('button[data-edit]');
      const delBtn = e.target.closest('button[data-del]');
      if(openBtn) openDetail(openBtn.dataset.id);
      if(editBtn && isAdmin()) openEdit(editBtn.dataset.id);
      if(delBtn && isAdmin()) deleteItem(delBtn.dataset.id);
    });
    document.getElementById('btn-edit-in-detail').addEventListener('click', ()=>{ if(currentDetailId) openEdit(currentDetailId); });
    document.getElementById('btn-del-in-detail').addEventListener('click', ()=>{ if(currentDetailId) deleteItem(currentDetailId); });
    document.getElementById('e-save').addEventListener('click', applyEdit);
    document.getElementById('e-cancel').addEventListener('click', ()=>edit.close());

    // ===== ê´€ë¦¬ì ë¡œê·¸ì¸(ë²„íŠ¼) =====
    const ADMIN_HASH = "7e224edda74c33886fbc3fa9a14c97ff2681f0862587ee99f91169489c59ef07"; // SALT+PW
    const SALT = "soodesign-v1";
    const SESSION_OK = "soodesign-admin-ok";

    async function sha256Hex(str){
      const enc=new TextEncoder().encode(str);
      const buf=await crypto.subtle.digest('SHA-256',enc);
      return [...new Uint8Array(buf)].map(b=>b.toString(16).padStart(2,'0')).join('');
    }
    function isAdmin(){ return sessionStorage.getItem(SESSION_OK) === '1'; }
    function showAdmin(){
      const el=document.querySelector('details.admin');
      if(el) el.style.display='block';
      document.body.classList.add('is-admin');
      render();
    }
    async function adminLogin(){
      const pw=prompt('ê´€ë¦¬ì ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”:'); if(!pw) return;
      const digest=await sha256Hex(SALT+pw);
      if(digest===ADMIN_HASH){
        sessionStorage.setItem(SESSION_OK,'1'); showAdmin(); alert('ê´€ë¦¬ì ëª¨ë“œ í™œì„±í™”');
      } else { alert('ë¹„ë°€ë²ˆí˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.'); }
    }
    document.getElementById('btn-admin-login').addEventListener('click', adminLogin);
    if(isAdmin()) showAdmin();

    // ===== ì´ˆê¸°í™” & ê´€ë¦¬ì(ì¶”ê°€/ê°€ì ¸ì˜¤ê¸°/ë‚´ë³´ë‚´ê¸°/ì´ˆê¸°í™”) =====
    (async()=>{ await loadData(); renderTags(); render(); })();

    document.getElementById('add').addEventListener('click', ()=>{
      if(!isAdmin()) return alert('ê´€ë¦¬ì ëª¨ë“œì—ì„œë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤.');
      const title = document.getElementById('f-title').value.trim();
      if(!title) return alert('ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”');
      const desc = document.getElementById('f-desc').value.trim();
      const tags = document.getElementById('f-tags').value.split(',').map(s=>s.trim()).filter(Boolean);
      const cover = document.getElementById('f-img').value.trim();
     const youtube = document.getElementById('f-yt').value.trim();
const gallery = document.getElementById('f-gallery').value
  .split('\n')
  .map(s => s.trim())
  .filter(Boolean)
  .slice(0, 10);
const id = Date.now();
const youtubeId = extractYouTubeId(youtube);
const isShorts = (youtube || "").includes("/shorts/");

items.unshift({
  id,
  title,
  desc,
  tags,
  cover,
  youtube,
  youtubeId,
  isShorts,
  gallery
});
      saveLocal(); renderTags(); render();
      alert('ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤. (ë¡œì»¬ ì €ì¥) JSON ë‚´ë³´ë‚´ê¸°ë¡œ ë°°í¬ íŒŒì¼ì„ ê°±ì‹ í•˜ì„¸ìš”.');
    });

    document.getElementById('export').addEventListener('click', ()=>{
      if(!isAdmin()) return alert('ê´€ë¦¬ì ëª¨ë“œì—ì„œë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤.');
      const blob = new Blob([JSON.stringify(items,null,2)], {type:'application/json'});
      const a = document.createElement('a'); a.href = URL.createObjectURL(blob); a.download = 'portfolio-data.json'; a.click(); URL.revokeObjectURL(a.href);
    });

    document.getElementById('import').addEventListener('change', (e)=>{
      if(!isAdmin()) return alert('ê´€ë¦¬ì ëª¨ë“œì—ì„œë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤.');
      const file = e.target.files[0]; if(!file) return;
      const fr = new FileReader();
      fr.onload = ()=>{
        try {
          items = JSON.parse(fr.result);
items.forEach(it=>{
  it.tags = it.tags || [];
  it.gallery = (it.gallery || []).slice(0,10);
  it.youtubeId = extractYouTubeId(it.youtube || "");
  it.isShorts = (it.youtube || "").includes("/shorts/");
});

          saveLocal(); renderTags(); render(); alert('ê°€ì ¸ì˜¤ê¸° ì™„ë£Œ(ë¡œì»¬ ì €ì¥). ë‚´ë³´ë‚´ê¸° í›„ repoì— ì—…ë¡œë“œí•˜ì„¸ìš”.');
        } catch(err){ alert('JSON í˜•ì‹ ì˜¤ë¥˜'); }
      };
      fr.readAsText(file);
    });

    document.getElementById('clear').addEventListener('click', ()=>{
      if(!isAdmin()) return alert('ê´€ë¦¬ì ëª¨ë“œì—ì„œë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤.');
      if(!confirm('ë¡œì»¬ ë°ì´í„°ë¥¼ ëª¨ë‘ ì‚­ì œí• ê¹Œìš”?')) return;
      localStorage.removeItem(KEY); items = seedData.slice(); renderTags(); render();
    });
  </script>
</body>
  
</html>
